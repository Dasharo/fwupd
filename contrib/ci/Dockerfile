FROM ubuntu:20.04
ENV OS ubuntu
ENV CI_NETWORK true
ENV CC clang
RUN echo fubar > /etc/machine-id
RUN apt update -qq
RUN git clone https://github.com/tpm2-software/tpm2-tss
RUN cd tpm2-tss
RUN ./bootstrap
RUN ./configure --enable-integration
RUN make -j$(nproc)
RUN make check
RUN gcc standalone-example.c -L=/usr/local/lib/ -ltss2-esys -o standalone-example
DEBIAN_FRONTEND=noninteractive apt install -yq --no-install-recommends\
	abigail-tools \
	abigail-tools \
	bash-completion \
	bash-completion \
	bubblewrap \
	bubblewrap \
	ca-certificates \
	ca-certificates \
	clang \
	clang \
	clang-tools \
	clang-tools \
	clang-format \
	clang-format \
	libcairo-dev \
	libcairo-dev \
	libcairo-gobject2 \
	libcairo-gobject2 \
	libjson-glib-dev \
	libftdi1-dev \
	libftdi1-dev \
	libpci-dev \
	libpci-dev \
	fonts-noto \
	fonts-noto \
	devscripts \
	devscripts \
	debhelper \
	debhelper \
	dbus-x11 \
	dbus-x11 \
	dh-strip-nondeterminism \
	dh-strip-nondeterminism \
	fakeroot \
	fakeroot \
	libfreetype6-dev \
	libfreetype6-dev \
	fontconfig \
	fontconfig \
	libflashrom-dev \
	gcab \
	gcab \
	gettext \
	gnu-efi \
	gnu-efi \
	git \
	git \
	libglib2.0-doc \
	libglib2.0-doc \
	libglib2.0-dev \
	gobject-introspection \
	gobject-introspection \
	gnome-desktop-testing \
	gnome-desktop-testing \
	gnutls-dev \
	gnutls-dev \
	gnutls-bin \
	gnutls-bin \
	gtk-doc-tools \
	gtk-doc-tools \
	libxmlb-dev \
	libjcat-dev \
	libjcat-dev \
	liblzma-dev \
	liblzma-dev \
	libarchive-dev \
	libarchive-dev \
	libefivar-dev \
	libefiboot-dev \
	libgcab-dev \
	libgcab-dev \
	libgirepository1.0-dev \
	libgirepository1.0-dev \
	libgudev-1.0-dev \
	libgudev-1.0-dev \
	libgusb-dev \
	libsmbios-dev \
	libsoup2.4-dev \
	libsoup2.4-dev \
	libcurl4-gnutls-dev \
	libcurl4-gnutls-dev \
	libtool-bin \
	libtool-bin \
	libumockdev-dev \
	libumockdev-dev \
	lintian \
	lintian \
	locales \
	locales \
	meson \
	meson \
	mingw-w64-tools \
	gir1.2-pango-1.0 \
	gir1.2-pango-1.0 \
	pkg-config \
	pkg-config \
	policykit-1 \
	libmm-glib-dev \
	libmm-glib-dev \
	libqmi-glib-dev \
	libqmi-glib-dev \
	libmbim-glib-dev \
	libmbim-glib-dev \
	libpolkit-gobject-1-dev \
	libpolkit-gobject-1-dev \
	python3-gi-cairo \
	python3-gi-cairo \
	python3-pygments \
	python3-pygments \
	python3-typogrify \
	python3-typogrify \
	python3-toml \
	python3-toml \
	python3-markdown \
	python3-markdown \
	python3-jinja2 \
	python3-jinja2 \
	python3-requests \
	python3-requests \
	libsqlite3-dev \
	libsqlite3-dev \
	systemd \
	libsystemd-dev \
	libsystemd-dev \
	shared-mime-info \
	shared-mime-info \
	texlive-fonts-recommended \
	texlive-fonts-recommended \
	udev \
	udev \
	umockdev \
	umockdev \
	valac \
	valac \
	valgrind \
	libtss2-dev \
	libtss2-esys \
	shellcheck \
	shellcheck \
	libprotobuf-c-dev \
	libprotobuf-c-dev \
	protobuf-c-compiler \
	protobuf-c-compiler \
	sudo \
	sudo \
	python3-venv \
	python3-venv 
WORKDIR /github/workspace
CMD ["./contrib/ci/debian.sh"]
